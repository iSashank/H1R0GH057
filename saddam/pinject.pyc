√≥
Z‚Äû‚Ä°Vc           @   s√µ   d  d l  Z  d  d l Z d  d l Z d  d l Z d  d l Z d  d l Z d  d l m Z d Z d ‚Äû  Z	 d d d ‚Äû  ∆í  YZ
 d e
 f d ‚Äû  ∆í  YZ d	 e
 f d
 ‚Äû  ∆í  YZ
 d
 e
 f d ‚Äû  ∆í  YZ d
 e
 f d ‚Äû  ∆í  YZ d ‚Äû  Z e d k r√± e ∆í  n  d S(   i√ø√ø√ø√øN(   t   OptionParseri   c         C   s¬∫   d } t  |  ∆í d } xN t d t  |  ∆í | d ∆í D]0 } | t |  | ∆í t |  | d ∆í d >7} q3 W| rÀÜ | t |  | d ∆í 7} n  x  | d ?r¬™ | d @| d ?} q‚Äπ W| d @} | S(   Ni    i   i   i   i   i√ø√ø  (   t   lent   ranget   ord(   t   datat   st   nt   i(    (    s-   /root/Desktop/webby/dos/dos/Saddam/pinject.pyt   checksum
   s    #.

t   layerc           B   s   e  Z RS(    (   t   __name__t
   __module__(    (    (    s-   /root/Desktop/webby/dos/dos/Saddam/pinject.pyR	      s   t   ETHERc           B   s   e  Z e d  ‚Äû Z d ‚Äû  Z RS(   c         C   s   | |  _  | |  _ | |  _ d  S(   N(   t   srct   dstt   type(   t   selfR
   R   R   (    (    s-   /root/Desktop/webby/dos/dos/Saddam/pinject.pyt   __init__   s    		c         C   s%   t  j d |  j |  j |  j ∆í } | S(   Ns   !6s6sH(   t   structt   packR   R
   R   (   R   t   ethernet(    (    s-   /root/Desktop/webby/dos/dos/Saddam/pinject.pyR      s
    	(   R
   R
   t   ETH_P_IPR   R   (    (    (    s-   /root/Desktop/webby/dos/dos/Saddam/pinject.pyR      s   t   IPc           B   s,   e  Z d  e j d ‚Äû Z d ‚Äû  Z d ‚Äû  Z RS(   t    c         C   s≈í   d |  _  d |  _ d |  _ d t | ∆í |  _ d |  _ d |  _ d |  _ d |  _ | |  _	 d |  _
 t
 j | ∆í |  _
 t
 j | ∆í |  _ d  S(   Ni   i   i    i   i√ø   i   (   t   versiont   ihlt   tosR   t   tlt   idt   flagst   offsett   ttlt   protocolR   t   sockett	   inet_atont   sourcet
   destination(   R   R#   R$   t   payloadt   proto(    (    s-   /root/Desktop/webby/dos/dos/Saddam/pinject.pyR   '   s    									c         C   s√é   |  j  d >|  j } |  j d >|  j } t j d | |  j |  j |  j | |  j	 |  j
 |  j
 |  j |  j
 ∆í
 } t
 | ∆í |  _
 t j d | |  j |  j |  j | |  j	 |  j
 t j |  j
 ∆í |  j |  j
 ∆í
 } | S(   Ni   i
   s
   !BBHHHBBH4s4s(   R   R   R   R   R   R   R   R   R   R   R    R   R#   R$   R!   t   htons(   R   t   ver_ihlt   flags_offsett	   ip_header(    (    s-   /root/Desktop/webby/dos/dos/Saddam/pinject.pyR   4   s4    		c      
   C   s?  t  ∆í  } t | d ∆í d @d | _ t j d | | j  ∆í } | d d ?| _ | d | _ | d | _ | d | _ | d d ?| _	 | d d	 @| _
 | d
 | _
 | d
 | _ t
 | d ∆í | _ t j | d
 ∆í | _ t j | d ∆í | _ | j | j | j | j | j | j	 | j
 | j
 | j | j | j g
 | _ | S(   Ni    i   i   s
   !BBHHHBBH4s4si   i   i   i
   i√ø  i   i   i   i   i	   (   R	   R   R   R   t   unpackt   verR   t   lengtht   idsR   R   R   R    t   hexR   R!   t	   inet_ntoaR
   R   t   list(   R   t   packett   _ipt   iph(    (    s-   /root/Desktop/webby/dos/dos/Saddam/pinject.pyR+   O   s4    	




(   R
   R
   R!   t
   IPPROTO_TCPR   R   R+   (    (    (    s-   /root/Desktop/webby/dos/dos/Saddam/pinject.pyR   &   s   
	t   TCPc           B   s#   e  Z d  ‚Äû  Z d ‚Äû  Z d ‚Äû  Z RS(   c         C   s¬ù   | |  _  | |  _ d |  _ d |  _ d |  _ d |  _ d |  _ d |  _ d |  _ d |  _	 d |  _
 d |  _
 t j
 d ∆í |  _ d |  _ d |  _ d |  _ d  S(   Ni
   i    i   i   i√ê  R   (   t   srcpt   dstpt   seqnt   acknR   t   reservedt   urgt   ackt   psht   rstt   synt   finR!   R'   t   windowR   t   urgpR%   (   R   R7   R8   (    (    s-   /root/Desktop/webby/dos/dos/Saddam/pinject.pyR   m   s     														c   
   
   C   s_  |  j  d >d } |  j |  j d >|  j d >|  j d >|  j d >|  j d >} t j d |  j	 |  j
 |  j
 |  j | | |  j
 |  j |  j ∆í
 } | } | } d } t j }	 t | ∆í t |  j ∆í }
 t j d | | | |	 |
 ∆í }
 |
 | |  j }
 t |
 ∆í } t j d	 |  j	 |  j
 |  j
 |  j | | |  j
 ∆í } | t j d
 | ∆í t j d
 |  j ∆í 7} | S(   Ni   i    i   i   i   i   s
   !HHLLBBHHHs   !4s4sBBHs   !HHLLBBHt   Hs   !H(   R   RA   R@   R?   R>   R=   R<   R   R   R7   R8   R9   R:   RB   R   RC   R!   R5   R   R%   (
   R   R#   R$   t
   data_offsetR   t
   tcp_headert	   source_ipt   destination_ipR;   R    t   total_lengthR>   t   tcp_checksum(    (    s-   /root/Desktop/webby/dos/dos/Saddam/pinject.pyR   ~   sF    @					)c      
   C   s¬Å  i d d 6d d 6d d 6d d 6d	 d
 6d
 d 6} t  ∆í  } t | d
 ∆í d ?d | _ | d | j !| _ | | j | _ t j d | d  ∆í } | d | _ | d | _ | d
 | _	 t
 | d ∆í | _
 d | _ x2 | D]* } | d | @r√ó | j | | 7_ q√ó q√ó W| d | _
 t
 | d ∆í | _ | d | _ | j | j | j	 | j
 | j | j | j
 | j | j | j | j g
 | _ | S(   Nt   Ui    t   Ai   t   Pi   t   Ri   t   Si   t   Fi   i   i   s
   !HHLLBBHHHi    i   R   i   i   i   (   R	   R   t   thlt   optionsR%   R   R+   R7   R8   t   seqR/   R=   R   RB   R   R<   R1   (   R   R2   t   cflagst   _tcpt   tcpht   f(    (    s-   /root/Desktop/webby/dos/dos/Saddam/pinject.pyR+   ¬§   sF    
	


	


(   R
   R
   R   R   R+   (    (    (    s-   /root/Desktop/webby/dos/dos/Saddam/pinject.pyR6   l   s   		&t   UDPc           B   s#   e  Z d  d ‚Äû Z e j d ‚Äû Z RS(   R   c         C   s1   | |  _  | |  _ | |  _ d |  _ d |  _ d  S(   Ni    i   (   R
   R   R%   R   R-   (   R   R
   R   R%   (    (    s-   /root/Desktop/webby/dos/dos/Saddam/pinject.pyR   √ã   s
    				c         C   sz   |  j  t |  j ∆í } t j d t j | ∆í t j | ∆í d | | ∆í } t | ∆í |  _ t j d |  j |  j	 | d ∆í } | S(   Ns   !4s4sBBHi    s   !HHHH(
   R-   R   R%   R   R   R!   R"   R   R
   R   (   R   R
   R   R&   R-   t
   pseudo_headerR2   (    (    s-   /root/Desktop/webby/dos/dos/Saddam/pinject.pyR   √ë   s    		(   R
   R
   R   R!   t
   IPPROTO_UDPR   (    (    (    s-   /root/Desktop/webby/dos/dos/Saddam/pinject.pyRX   √ä   s   c    
   
   C   s∆í  t  ∆í  }  |  j d d d d d d d d d	 d
 ∆í|  j d
 d d d
 d d d d d	 d
 ∆í|  j ∆í  \ } } | j d  k r‚Äò |  j ∆í  t j ∆í  n t j	 | j ∆í } | j
 d  k r√ä t j	 t j
 ∆í  ∆í } n	 | j
 } d | GHd | GHd } d | GHt | | ∆í } t
 d d ∆í } t | | d d d d d d ∆í} | r| j | ∆í }	 | |	 j } | j | ∆í }
 d G|	 j GHd G|
 j GHn  d  S(   Ns   -ss   --srct   destR
   R   t   stringt   helps   Source IP addresst   metavarR   s   -ds   --dstR   s   Destination IP addresss   [+] Local Machine: %ss   [+] Remote Machine: %ss   TEST!!s   [+] Data to inject: %si√í  iP   t   ifacet   eth0t   retryi   t   timeoutg333333√ì?s
   IP Header:s
   TCP Header:(   R    t
   add_optiont
   parse_argsR   t   Nonet
   print_helpt   syst   exitR!   t
   gethostbynameR
   t
   gethostnameR   R6   t   sendR+   R   R1   (
   t   parserRR   t   argst   dst_hostt   src_hostR   t   ipobjt   tcpobjt   responset   ipt   tcp(    (    s-   /root/Desktop/webby/dos/dos/Saddam/pinject.pyt   main√õ   s4    	



				!
t   __main__(    (   R!   R   t	   threadingt   timeRg   t   randomt   optparseR    R   R   R	   t   objectR   R   R6   RX   Ru   R
   (    (    (    s-   /root/Desktop/webby/dos/dos/Saddam/pinject.pyt   <module>   s    	F^	"
